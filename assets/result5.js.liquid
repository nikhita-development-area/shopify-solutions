var getUrlParameter = function getUrlParameter(sParam) {
  var sPageURL = window.location.search.substring(1),
      sURLVariables = sPageURL.split('&'),
      sParameterName,
      i;

  for (i = 0; i < sURLVariables.length; i++) {
    sParameterName = sURLVariables[i].split('=');

    if (sParameterName[0] === sParam) {
      return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
    }
  }
};

var id = getUrlParameter('id'), f_name, C_number, user__gender, user_gender;

var cohort = getUrlParameter('cohort');

if (id) {
  localStorage.setItem('rid', id);
}

id = localStorage.getItem('rid');

if (!id) {
  alert('Your recommendation is not found. Please fill the diagnosis to help us share the recommended plan.');
  document.location.href= 'https://form.traya.health/questions?cohort=1&source=ResultPage'
  jQuery('[data-formPage]').show();
  jQuery('[data-resultPage]').hide();
}
var baseUrls = {
  DEV: 'https://api.v2dev.hav-g.in/',
  PROD: 'https://api.hav-g.in/'
}
var tokens = {
  DEV:{ 
    "Authorization": "Bearer e2623576-930b-48b6-81e2-a3cb5e37f47d"
  },
  PROD: { 
    "Authorization": "Bearer d7ef603e-71ea-44a1-93f2-2bacd08c4a90"
  }
}
var token = tokens.PROD;
var baseUrl = baseUrls.PROD;
var liveendpoint = 'https://api.hav-g.in/dgReport?id=';
if (cohort == 2) {
  liveendpoint = baseUrl + 'dgReport/v2?id=';
} else {
  liveendpoint = baseUrl + 'dgReport/v1?id=';
}
liveendpoint = 'https://api.hav-g.in/dgReport/v4?id=';
var stageDescription = {
  "Stage-1": "You’ve come to us at the right time! We can help you get that voluminous hair back.",
  "Stage-2": "Your hair loss has begun but you’re just in time to re-grow them quickly!",
  "Stage-3": "Your hair loss is significant but we can help you regrow and control any further hair loss.",
  "Stage-4": "Hair loss at this stage is manageable, start immediately for best results.",
  "Stage-5": "At this stage we cannot guarantee hair regrowth but can stop further hair loss.",
  "Stage-6": "At this stage we cannot guarantee hair regrowth but can stop further hair loss.",
  "Heavy Hair Fall Across The Head": "Your hair loss is 100% reversible. All we have to do is treat the root cause.",
  "Coin Size Patch": "You have alopecia areata. It’s quite difficult to treat this type of hair loss."
};

var selectedStage = 'Stage-1';


var variantsID = 0;
function displayProduct(data) {
var $ = jQuery;
  var r = Object.assign(data.User_Analysis, data.Recommendations);
  f_name = r.first_name;
  l_name = r.last_name;
  C_number = r.phone;
  user__gender = r.gender;
  if(user__gender == 'M') {
    user_gender = 'Male';
  }else if(user__gender == 'F') {
    user_gender = 'Female';
  }

  $('.productt').hide();
  // if (r.Health_tatva === 'Yes') {
  //   $('#healthTatva').show();
  //   getProductByHandle('herbal-tablets');
  //   var Desc = 'Ayurvedic herbs to boost absorption of nutrients for improved energy and hair health';
  // }

  if (r.Gut_shuddi === 'Yes') {
    $('#gutShuddhi').show();
    getProductByHandle('avipattikar-digestion-tablets');
    var Desc = 'Ayurvedic herbs for improved digestion, gut health and hair';
  }
  if (r.Minoxidil === 'Yes' && r.gender === 'M') {
    getProductByHandle('traya-minoxidil-5');
    $('#hairSerum').show();
    var Desc = 'Minoxidil 5% for male androgenic alopecia hair loss and hair growth';
  }
  if (r.Minoxidil === 'Yes' && r.gender === 'F') {
    getProductByHandle('minoxidil-2');
    $('#hairSerum').show();
    var Desc = 'Minoxidil 2% treatment for female androgenic alopecia hair loss and hair growth';
  }
  if (r.Shampoo === 'Normal') {
    $('#shampooDarmotology').show();
    getProductByHandle('shampoo');
    var Desc = 'Chemical-free hair and scalp cleanser shampoo';
  }
  if (r.Shampoo === 'Anti dandruff') {
    $('#hairAntidandruff').show();
    getProductByHandle('anti-dandruff-shampoo');
    var Desc = 'Made with antifungal ingredients for getting rid of dandruff of all types';
  }
  if (r.Hair_vitamin == 'Yes') { 
    $('#hairVitamins').show();
    getProductByHandle('hair-vitamins');
    var Desc = '100% Vegetarian supplements for hair to combat vitamin deficiency related hair loss';
  }

  if ((r.Serum === 'Yes') && (r.RCP === 'No')) {
    $('#hairRootserum').show();
    getProductByHandle('recap-serum-for-hair-fall-control');
    var Desc = 'Patented hair growth serum with redensyl, biotin and caffeine';
  } 
  
  if (r.RCP === 'Yes') {
    $('#hairRootserum').show();
    getProductByHandle('recap-serum-for-hair-fall-control');
    var Desc = 'Patented hair growth serum with redensyl, biotin and caffeine';
  }
  
  if (r.Hair_ras === 'Yes') {
    getProductByHandle('hair-growth-herbs');
    var Desc = 'Better hair quality & delayed greying with herbs like shatavari and bhringraj';
  }

  if (r.Scalp_oil === 'Yes' || r.Scalp_oil === 'bergamot and ylang ylang') {
        var boosterOil = '';
    if (r.Calm_Therapy_Booster_Oil === 'Yes'){
     boosterOil = ' + Calm Therapy Booster Oil';
     getProductByHandle('scalp-oil-with-calm-therapy-booster-shots', boosterOil);
    }else if (r.Dandruff_Therapy_Booster_Oil === 'Yes'){
     boosterOil = ' + Dandruff Therapy Booster Oil';
      getProductByHandle('scalp-oil-with-dandruff-therapy-booster-shots', boosterOil);
    }else if (r.Growth_Therapy_Booster_Oil === 'Yes'){
     boosterOil = ' + Growth Therapy Booster Oil';
      getProductByHandle('scalp-oil-with-growth-therapy-booster-shots', boosterOil);
    }else if (r.Scalp_Therapy_Booster_Oil === 'Yes'){
     boosterOil = ' + Scalp Therapy Booster Oil';
      getProductByHandle('scalp-oil-with-scalp-therapy-booster-shots', boosterOil);
    }else{
     getProductByHandle('scalp-oil-with-growth-therapy-booster-shots', boosterOil); 
    }
    $('#scalpOil').show();
    
    var Desc = 'Herbal hair oil with essential oils, customised based on scalp and hair type';
  }

  if (r.Kevon === 'Yes') {
     getProductByHandle('ketoconazole-2-night-lotion');
    // getProductByHandle('kevon-lotion-1');
  }
  
  // if (r.Nasya === 'Yes') {
  //   getProductByHandle('shatavari-ghrita');
  //   var Desc = 'Ayurvedic nasal drops for nourishing hair follicles and reducing sleep-related hair loss';
  // }
  
  // if (r.Digest_Boost === 'Yes') {
  //     getProductByHandle('digest-boost-for-improved-digestive-ability-traya-health');
  //     var Desc = 'A herbal, all-natural formulation with saunf and jeera for relieving digestive problems.';
  // }
  
  if(r.gender === 'M'){
    $('[data-gender]').append('Male');
  } else {
    $('[data-gender]').append('Female');
  }
  
}


var prices = 0;
var variantsIDs = [];
function getProductByHandle(handle, adtitle) {
var $ = jQuery;
  jQuery.getJSON('/products/'+handle+'.js', function(product) {
    var p = product.price;
    prices = prices + p;
    $('#price').html('₹' + JSON.stringify(prices).slice(0, -2) + '');
    var discountPrice, discountedPrice, discount ;
    var selectedMonth = $('.select-plan [name="month"]:checked').closest('label');
    discount = selectedMonth.find('.main-persentage').data('discount');
    discountPrice = (prices *discount)/100;
    discountedPrice = prices - discountPrice;
//  1 month discount price
    var month_1_des=$('.month-plan-1').find('.main-persentage').data('discount');
    var discount_month_1=prices-((prices *month_1_des)/100);
    $('[three_month_plancard] .all-total-price').html(theme.Currency.formatMoney(discountedPrice*4, theme.moneyFormat));
//     $('.total-price').html(theme.Currency.formatMoney(discountedPrice*3, theme.moneyFormat));
    $('[one_month_plancard] .total-price').html(theme.Currency.formatMoney(discount_month_1, theme.moneyFormat));
    $('[three_month_plancard] .total-price').html(theme.Currency.formatMoney(prices*4, theme.moneyFormat));
    $('[three_month_plancard] .total__discout_price_cstm').html(theme.Currency.formatMoney(discountedPrice*4, theme.moneyFormat));
    $('.total-price-1').html(theme.Currency.formatMoney(prices, theme.moneyFormat));
    $('.total-price-3').html(theme.Currency.formatMoney(prices * 4, theme.moneyFormat));
   $('[data-1month]').attr('data-1month', prices).attr('data-3month', discountedPrice*4);
    $('.total__discount_price_1').html(theme.Currency.formatMoney(discount_month_1, theme.moneyFormat));
    $('.total__discount_price_3').html(theme.Currency.formatMoney(discountedPrice*4, theme.moneyFormat));

    var fee = parseInt($('[data-docotr-fee]').attr('data-docotr-fee')); 
    $('[three_month_plancard] [data-docotr-fee]').html(theme.Currency.formatMoney(fee * $('.select-plan [name="month"]:checked').val(), theme.moneyFormat));
     
    var dietPlan = parseInt($('[data-diet-plan]').attr('data-diet-plan'));  
    $('[three_month_plancard] [data-diet-plan]').html(theme.Currency.formatMoney(dietPlan * $('.select-plan [name="month"]:checked').val(), theme.moneyFormat));

    var hairCoach = parseInt($('[data-hair-coach]').attr('data-hair-coach'));  
    $('[three_month_plancard] [data-hair-coach]').html(theme.Currency.formatMoney(hairCoach * $('.select-plan [name="month"]:checked').val(), theme.moneyFormat));
    
//     var total__fess=(discountedPrice * $('.select-plan [name="month"]:checked').val())+(fee * $('.select-plan [name="month"]:checked').val())+(dietPlan * $('.select-plan [name="month"]:checked').val())+(hairCoach * $('.select-plan [name="month"]:checked').val());
    var total__fess=(prices * $('.select-plan [name="month"]:checked').val())+(fee * $('.select-plan [name="month"]:checked').val())+(dietPlan * $('.select-plan [name="month"]:checked').val())+(hairCoach * $('.select-plan [name="month"]:checked').val());
    $('[three_month_plancard] .all-total-price').html(theme.Currency.formatMoney(total__fess, theme.moneyFormat));
    
    var fees_charge = (fee * $('.select-plan [name="month"]:checked').val())+(dietPlan * $('.select-plan [name="month"]:checked').val())+(hairCoach * $('.select-plan [name="month"]:checked').val());
   
    var percent_discount=100 - Math.round((((total__fess - fees_charge)/total__fess)*100));
   // $('.persentage').text('('+percent_discount +'% Off)');
    $('.persentage').text('(₹'+(fees_charge + discountPrice*$('.select-plan [name="month"]:checked').val()) /100 +' Off)');
    var total_fees_charge_month_1=(discount_month_1* $('.month-plan-1 [name="month"]').val())+(fee * $('.month-plan-1 [name="month"]').val())+(dietPlan * $('.month-plan-1 [name="month"]').val())+(hairCoach * $('.month-plan-1 [name="month"]').val());
    var fees_charge_month_1=(fee * $('.month-plan-1 [name="month"]').val())+(dietPlan * $('.month-plan-1 [name="month"]').val())+(hairCoach * $('.month-plan-1 [name="month"]').val());
    var percent_discount_month_1=100 - Math.round((((total_fees_charge_month_1 - fees_charge_month_1)/total_fees_charge_month_1)*100));
    let total_saving_1 = (fees_charge_month_1)/100;
    $('[one_month_plancard] .all-total-price, .one_month_tt_price').html(theme.Currency.formatMoney(total_fees_charge_month_1, theme.moneyFormat));
    $('.month-plan-1 .main-persentage').text(percent_discount_month_1+'%');
    $('[one_month_plancard] [top_pct_text]').text(percent_discount_month_1+'%');
//     $('.month-plan-1 .main-persentage').text('(₹'+total_saving_1+' Off)');
    
    var total_fees_charge_month_3=(discountedPrice* $('.month-plan-3 [name="month"]').val())+(fee * $('.month-plan-3 [name="month"]').val())+(dietPlan * $('.month-plan-3 [name="month"]').val())+(hairCoach * $('.month-plan-3 [name="month"]').val());
    var fees_charge_month_3=(fee * $('.month-plan-3 [name="month"]').val())+(dietPlan * $('.month-plan-3 [name="month"]').val())+(hairCoach * $('.month-plan-3 [name="month"]').val());
    //var percent_discount_month_3 = 100 - Math.round((((total_fees_charge_month_3 - fees_charge_month_3)/total_fees_charge_month_3)*100));
     var percent_discount_month_3 =  Math.round(((total__fess - discountedPrice*4)/total__fess)*100);
    // console.log('percent_discount_month_3', percent_discount_month_3);
//    console.log("total__fess>> ",total__fess);
//     console.log("discountedPrice*3>> ",discountedPrice*3);
    $('.three_month_tt_price').html(theme.Currency.formatMoney(total__fess, theme.moneyFormat));
    $('.month-plan-4 .main-persentage').text(percent_discount_month_3+'%');
    $('[three_month_plancard] [top_pct_text]').text(percent_discount_month_3+'%');
    let total_saving_3 = (fees_charge_month_3 + discountPrice*4)/100;
//     $('.month-plan-3 .main-persentage').text('(₹'+total_saving_3+' Off)');
    $('#add-to-cart-result-page').html('Buy Now <span>( '+$('.select-plan [name="month"]:checked').val()+' Month Plan )</span>');
    
    /* added by neeraj end  */
   
    var qty = parseInt($('[name="month"]:checked').val());
    if(qty == 1){
      var discount = '22%';
    } else if(qty == 3){
      var discount = '33%';
    }

    variantsIDs.push({
      'id': product.variants[0].id,
      'quantity': qty,
      'properties': {}
    });
  });

  fetch('/products/'+handle+'?view=result-product-list')
    .then(response => {
      return response.text();
    }).then(result => {
      var html = result;
        $('.product-section .container > .row').append(html);
    });
}

function checkout(plan) {
  localStorage.setItem('user__gender',user_gender);
  var $ = jQuery, plan;
  if(plan == "single"){
  var qty = 1;
  }else{
  var qty =$('[name="month"]:checked').val();
  }
  if(qty == 4){
    plan = "4 Months";
  }else{
     plan = "";
  }
  variantsIDs.forEach(e => {
      e.quantity = qty,
      e.properties = {'Plan': plan};
  });
  if(qty == 4){
  var formData = {
    'items': variantsIDs,
    sections: 'cart-drawer',
    attributes: {
      first_name: f_name,
      phone: C_number
    }
  }
  }else{
    var formData = {
    'items': variantsIDs,
    sections: 'cart-drawer',
    attributes: {
      first_name: f_name,
      phone: C_number
    }
  }
  }

  fetch('/cart/add.js', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(formData)
  })
  .then(response => {
    localStorage.setItem('User_location', "cart");
    $('.site-header__cart.js-drawer-open-right').trigger('click');
//     document.location.href = '/cart';
    return response.json();
  }).then(result => { 
      var t = document.querySelector('cart-drawer');
      let cart_drawer = result.sections['cart-drawer'];
      CartDrawerUpdate(t, cart_drawer);
    }).catch((error) => {
    console.error('Error:', error);
  });
}

function buyItNow() {
var $ = jQuery;
  let formData = {
    'items': variantsIDs
  };

  fetch('/cart/add.js', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(formData)
  })
  .then(response => {
    localStorage.setItem('User_location', "checkout");
    document.location.href = '/cart/checkout';
    return response.json();
  })
  .catch((error) => {
    console.error('Error:', error);
  });
}

function ChangePrice(){
  var $ = jQuery;
  var getMonth = $('.select-plan [name="month"]:checked');
  var mainLabel = $(getMonth).closest('label');
  var price = mainLabel.find('.discounted-price').text(),
      mainPer = mainLabel.find('.main-persentage').text(),
      mainmsg =  mainLabel.find('.radio_content_msg>span:not(.save_pct)').text(),
      month = $('.select-plan [name="month"]:checked').val();
  
    var selectedMonth = $('.select-plan [name="month"]:checked').closest('label'); 
    var discount_month=$('.select-plan [name="month"]:checked').val();
     var discountPrice, discountedPrice, discount ;
    discount = selectedMonth.find('.main-persentage').data('discount');
    discountPrice = (prices *discount)/100;
    discountedPrice = prices - discountPrice;
  
  $('.select-plan label.active').removeClass('active');
  
  if($('.select-plan [name="month"]:checked').val() == 1){    
    var dataMonth = $('[data-1month]').attr('data-1month')
    $('.plan-title').text('1 month plan');    
    }else{
      var dataMonth = $('[data-1month]').attr('data-3month');
      $('.plan-title').text('4 months plan');
      }
  $('.select-plan [name="month"]:checked').closest('label').addClass('active');
  var fee = parseInt($('[data-docotr-fee]').attr('data-docotr-fee')); 
 $('[three_month_plancard] [data-docotr-fee]').html(theme.Currency.formatMoney(fee * $('.select-plan [name="month"]:checked').val(), theme.moneyFormat));
  
  var dietPlan = parseInt($('[data-diet-plan]').attr('data-diet-plan'));  
  $('[three_month_plancard] [data-diet-plan]').html(theme.Currency.formatMoney(dietPlan * $('.select-plan [name="month"]:checked').val(), theme.moneyFormat));
  
  var hairCoach = parseInt($('[data-hair-coach]').attr('data-hair-coach'));  
  $('[three_month_plancard] [data-hair-coach]').html(theme.Currency.formatMoney(hairCoach * $('.select-plan [name="month"]:checked').val(), theme.moneyFormat));
  
//   $('.all-total-price').html(theme.Currency.formatMoney(dataMonth, theme.moneyFormat))
// var total__fess=(discountedPrice * $('.select-plan [name="month"]:checked').val())+(fee * $('.select-plan [name="month"]:checked').val())+(dietPlan * $('.select-plan [name="month"]:checked').val())+(hairCoach * $('.select-plan [name="month"]:checked').val());
  var total__fess=(prices * $('.select-plan [name="month"]:checked').val())+(fee * $('.select-plan [name="month"]:checked').val())+(dietPlan * $('.select-plan [name="month"]:checked').val())+(hairCoach * $('.select-plan [name="month"]:checked').val());
var fees_charge=(fee * $('.select-plan [name="month"]:checked').val())+(dietPlan * $('.select-plan [name="month"]:checked').val())+(hairCoach * $('.select-plan [name="month"]:checked').val());
    $('.persentage').text(mainPer);
  
  var percent_discount=Math.round((((total__fess - fees_charge)/total__fess)*100.00));
 console.log(percent_discount);
//   $('.persentage').text('('+percent_discount +'% Off)');
   $('[three_month_plancard] [top_pct_text]').text(mainPer.split('%')[0]+'%');
   $('.three_month_header_msg').text(mainmsg);
  

  console.log('discountPrice', discountPrice, 'discountedPrice', discountedPrice);

  var discount = mainLabel.find('.main-persentage').data('discount');
  if(discount == 22 || discount == '22'){
    console.log('22');
    var selectedMonth = $('.select-plan [name="month"]:checked').closest('label');
    discount = selectedMonth.find('.main-persentage').data('discount');
    discountPrice = (prices *discount)/100;
    discountedPrice = prices - discountPrice;$('.all-total-price').html(theme.Currency.formatMoney(prices, theme.moneyFormat));
//     $('.total-price').not('.discounted-price').html(theme.Currency.formatMoney(discountedPrice, theme.moneyFormat));
    $('.total-price').not('.discounted-price').html(theme.Currency.formatMoney(prices, theme.moneyFormat));
     $('.total__discout_price_cstm').html(theme.Currency.formatMoney(discountedPrice, theme.moneyFormat));
   // window.open('https://traya.health/discount/22%2525off','_blank');   
    $('#add-to-cart-result-page').html('Buy Now <span>( 1 Month Plan )</span>');
  }
  else if(discount == 33 || discount == '33'){
    console.log('33');
    var selectedMonth = $('.select-plan [name="month"]:checked').closest('label'); 
    discount = selectedMonth.find('.main-persentage').data('discount');
    discountPrice = (prices *discount)/100;
    discountedPrice = prices - discountPrice;
    $('.all-total-price').html(theme.Currency.formatMoney(prices*4, theme.moneyFormat));
//     $('.total-price').not('.discounted-price').html(theme.Currency.formatMoney(discountedPrice*3, theme.moneyFormat));
    $('.total-price').not('.discounted-price').html(theme.Currency.formatMoney(prices*4, theme.moneyFormat));
    $('.total__discout_price_cstm').html(theme.Currency.formatMoney(discountedPrice*4, theme.moneyFormat));
  //  window.open('https://traya.health/discount/33%2525off','_blank');
    $('#add-to-cart-result-page').html('Buy Now <span>( 4 Month Plan )</span>');
  }
  else{
//     $('.all-total-price').html(theme.Currency.formatMoney(prices * discount_month, theme.moneyFormat));
    $('.all-total-price').html(theme.Currency.formatMoney(total__fess, theme.moneyFormat));
//     $('.total-price').not('.discounted-price').html(theme.Currency.formatMoney(discountedPrice*3, theme.moneyFormat));
    //$('.total-price').not('.discounted-price').html(theme.Currency.formatMoney(discountedPrice * discount_month, theme.moneyFormat));
    $('.total-price').not('.discounted-price').html(theme.Currency.formatMoney(prices * discount_month, theme.moneyFormat));
    $('.total__discout_price_cstm').html(theme.Currency.formatMoney(discountedPrice * discount_month, theme.moneyFormat));
  //  window.open('https://traya.health/discount/33%2525off','_blank');
    $('#add-to-cart-result-page').html('Buy Now <span>( '+discount_month+' Month Plan )</span>');
  }
  
}

jQuery('body').on('click', '#add-to-cart-result-page, [three_month_plancard] .card_buy_now', function() {
  jQuery.ajax({
    type: "POST",
    url: '/cart/clear.js',
    success: function(){
      setTimeout(function(){
        checkout();
      },1000);
    },
    dataType: 'json'
  });

});

jQuery('body').on('click', '#buyNowResult2', function() {

  jQuery.ajax({
    type: "POST",
    url: '/cart/clear.js',
    success: function(){
      buyItNow();
    },
    dataType: 'json'
  });

});
jQuery('body').on('click', '[one_month_plancard] .card_buy_now', function() {
  jQuery.ajax({
    type: "POST",
    url: '/cart/clear.js',
    success: function(){
      setTimeout(function(){
        checkout('single');
      },1000);
    },
    dataType: 'json'
  });
});

var clearCart = function() {

  jQuery.ajax({
    type: "POST",
    data: {sections: 'cart-drawer'},
    url: '/cart/clear.js',
    success: function(e){
      var t = document.querySelector('cart-drawer');
      let cart_drawer = e.sections['cart-drawer'];
      CartDrawerUpdate(t, cart_drawer, drawer=false,0);
    },
    dataType: 'json'
  });

};

jQuery(document).ready(function($){
  clearCart();
  jQuery.ajax({
    url: liveendpoint+id,
    dataType: 'json',
    headers: token
  })
  .done(function(data){
    displayProduct(data);
    $('[data-user-name]').text(data.User_Analysis.first_name);
    $('#name1').text(data.User_Analysis.first_name);
    $('#name3').text(data.User_Analysis.first_name);
    $('#typeOfLoss').text(data.Recommendations.Type_of_hair_loss);
    $('#stage').text(data.User_Analysis.stage);
    $('#typeOfLoss3').text(data.Recommendations.Type_of_hair_loss);
    $('#stage3').text(data.User_Analysis.stage);
    console.log(data);
    $('#stageDescription').text(stageDescription[data.User_Analysis.stage]);

    selectedStage = data.User_Analysis.stage;

    $('.' + selectedStage).addClass('selectedStage');

    if (selectedStage === 'Stage-1') {
      $('.customers-section .start-journey-btn').hide();
    } else if (selectedStage === 'Stage-1') {
    } else if (selectedStage === 'Stage-2') {
      $('.Stage-1').addClass('checkStage');
      $('.customers-section .start-journey-btn').hide();
    } else if (selectedStage === 'Stage-3') {
      $('.Stage-1').addClass('checkStage');
      $('.customers-section .start-journey-btn').hide();
    } else if (selectedStage === 'Stage-4') {
      $('.Stage-2').addClass('checkStage');
      $('.customers-section .start-journey-btn').hide();

    } else if (selectedStage === 'Stage-5') {
	// $('.product-section.pt-2').hide();
      // $('.product-section-list.pt-5').hide();
      // $('.issue__v').hide();
//      $('.root__causes_v').addClass('root_causes_bottom_space');
      // $('#add-to-cart-result-page').addClass('hide__sticky__btn');
      // $('#custom-btn-5').removeClass('d-none');
      // $('.hero-text-ptyu').hide();
      $('.page-result-hero #stageDescription').addClass('h4');
      $('.customers-section .start-journey-btn').hide();
    // $('.root__causes_v').text('Sorry we are not treat for this stage');
      $('.Stage-3').addClass('checkStage');
    } else if (selectedStage === 'Stage-6') {
	// // // $('.product-section.pt-2').hide();
      // // $('.product-section-list.pt-5').hide();
      // $('.issue__v').hide();
//      $('.root__causes_v').addClass('root_causes_bottom_space');
      // $('.hero-text-ptyu').hide();
      // $('#add-to-cart-result-page').addClass('hide__sticky__btn');
      // $('#custom-btn-5').removeClass('d-none');
      $('.page-result-hero #stageDescription').addClass('h4');
      $('.customers-section .start-journey-btn').hide();
     // $('.root__causes_v').text('Sorry we are not treat for this stage');
      $('.Stage-5').addClass('checkStage');
    } else if (selectedStage === 'Coin Size Patch') {
      //$('.Stage-1').addClass('checkStage');
       $('.Stage-7').addClass('selectedStage');
      $('h2.pattern_v').hide();
      $('.product-section.pt-2').hide();
      $('.product-section-list.pt-5').hide();
      $('.issue__v').hide();
      $('.hero-text-ptyu').hide();
     // $('.root__causes_v').addClass('root_causes_bottom_space');
      $('#add-to-cart-result-page').addClass('hide__sticky__btn');
      $('#custom-btn').removeClass('d-none');
      $('.page-result-hero #stageDescription').addClass('h4');
      //$('.root__causes_v').text('Sorry we are not treat for this stage');
    } else if (selectedStage === 'Heavy Hair Fall Across The Head') {
      $('h2.pattern_v').hide();
      $('.Stage-8').addClass('selectedStage');
      $('.Stage-2').addClass('checkStage');
      $('.customers-section .start-journey-btn').hide();
    }

    $('.diagnoses-result > img').hide();

    $('#ourdia li').hide();
    var type = data.Recommendations.Type;
    var Genetic = data.Recommendations.Genetic;
    var User_Analysis = data.User_Analysis;
    var Recommendations = data.Recommendations;

    let count=0;
    if ((type == 1 || type==2 ) && Genetic == "Yes"){
      $('#genetics').css('display','flex');

      count++;
    } 
    if (JSON.parse(User_Analysis.stress) <1){
      $('#stress').css('display','flex');
      count++;
    }
    if (JSON.parse(User_Analysis.sleep) <1){
      $('#sleepissues').css('display','flex');
      count++;
    }
    if (JSON.parse(User_Analysis.gut_health) <1  && count<4){
      $('#digestion').css('display','flex');
      count++;
    }
    if (Recommendations.Deficiency == "Yes"  && count<4){
      $('#deficiency').css('display','flex');
      count++;
    }
    if (Recommendations.Dieting == "Yes" && count<4){
      $('#weightloss').css('display','flex');
      count++;

    }
    if (count<4){
      $('#nutrition').css('display','flex');
      count++;

    }
    if (count<4){
      $('#lifestyle').css('display','flex');
      count++;
    }

    if (type === 5) {
      $('ul#ourdia li').hide();
      $('#malfunction').css('display','flex');
    }

    $('.theresults').hide();

    if (data.User_Analysis.gender === 'F') {
       $('.review-resultco-M').remove();
      $('#female-result').show();
      $('.page-result-hero').removeClass('male');
      $('.page-result-hero').addClass('female');
    } else {
       $('.review-resultco-F').remove();
      $('#male-result').show();
      $('.page-result-hero').addClass('male');
      $('.page-result-hero').removeClass('female');
    }
    $('.slick-items-container-result').slick({
      infinite: true,
      dots: false,
      autoplay: true,
      arrows: true,
      swipe : true,
      adaptiveHeight: true
    });
    var Max_months = data.Recommendations.Max_months;
    if (Max_months < 6) {
      $('#regroMonth1').text('1 MONTH');
      $('#regroMonth2').text('2-3 MONTHS');
      $('#regroMonth3').text('4-5 MONTHS');
    }

    if (Max_months === 6) {
      $('#regroMonth1').text('1 MONTH');
      $('#regroMonth2').text('2-4 MONTHS');
      $('#regroMonth3').text('5-6 MONTHS');
    }

    if (Max_months > 6) {
      $('#regroMonth1').text('1-2 MONTHS');
      $('#regroMonth2').text('3-5 MONTHS');
      $('#regroMonth3').text('5-8 MONTHS');
    }


    var r = data.Recommendations;
      setTimeout(function(){
        jQuery('.result_product_slides').slick({
          mobileFirst: true,
          autoplay: true,
          autoplaySpeed: 2000,
          arrows: false,
          dots:true,
          adaptiveHeight: true,
          responsive: [
            {
              breakpoint: 760,
              settings: "unslick"
            }
          ]
        });
      },2e3);
  });
});


jQuery('body').on('click', '[data-thumb] > div img', function(){
  var $ = jQuery;
  var Image = $(this).attr('src');
  $('[data-main-image] img').attr('src', Image);
});

jQuery(document).ready(function($){

  var stages = {
    "Stage-1": {
      "desc": "",
      "img": "https://cdn.shopify.com/s/files/1/0100/1622/7394/files/stage01.png"
    },
    "Stage-2": {
      "desc": "",
      "img": "https://cdn.shopify.com/s/files/1/0100/1622/7394/files/stage02.png"
    },
    "Stage-3": {
      "desc": "",
      "img": "https://cdn.shopify.com/s/files/1/0100/1622/7394/files/stage03.png"
    },
    "Stage-4": {
      "desc": "",
      "img": "https://cdn.shopify.com/s/files/1/0100/1622/7394/files/stage04.png"
    },
    "Stage-5": {
      "desc": "",
      "img": "https://cdn.shopify.com/s/files/1/0100/1622/7394/files/stage05.png"
    },
    "Stage-6": {
      "desc": "",
      "img": "https://cdn.shopify.com/s/files/1/0100/1622/7394/files/stage06.png"
    },
    "Stage-7": {
      "desc": "",
      "img": ""
    },
    "Heavy Hair Fall Across The Head": {
      "desc": "",
      "img": ""
    },
    "Coin Size Patch": {
      "desc": "",
      "img": ""
    }
  }

  $('#range-img-stage').attr('src', stages[selectedStage].img);
  $('#range-text-stage').text(stages[selectedStage].desc);

  $('#range').change(function(){
    var slider = $(this).val();

    if (selectedStage === 'Stage-1') {
      $('#range-img-stage').attr('src', stages[selectedStage].img);
      $('#range-text-stage').text(stages[selectedStage].desc);
    }

    if (selectedStage === 'Stage-2') {
      $('#range-img-stage').attr('src', stages[selectedStage].img);
      $('#range-text-stage').text(stages[selectedStage].desc);
      if (slider === 3) {
        $('#range-img-stage').attr('src', stages['Stage-1'].img);
        $('#range-text-stage').text(stages['Stage-1'].desc);
      }
    }

    if (selectedStage === 'Stage-3') {
      $('#range-img-stage').attr('src', stages[selectedStage].img);
      $('#range-text-stage').text(stages[selectedStage].desc);
      if (slider === 2) {
        $('#range-img-stage').attr('src', stages['Stage-2'].img);
        $('#range-text-stage').text(stages['Stage-2'].desc);
      }
      if (slider === 3) {
        $('#range-img-stage').attr('src', stages['Stage-1'].img);
        $('#range-text-stage').text(stages['Stage-1'].desc);
      }
    }

    if (selectedStage === 'Stage-4') {
      $('#range-img-stage').attr('src', stages[selectedStage].img);
      $('#range-text-stage').text(stages[selectedStage].desc);
      if (slider === 2) {
        $('#range-img-stage').attr('src', stages['Stage-3'].img);
        $('#range-text-stage').text(stages['Stage-3'].desc);
      }
      if (slider === 3) {
        $('#range-img-stage').attr('src', stages['Stage-2'].img);
        $('#range-text-stage').text(stages['Stage-2'].desc);
      }
    }
  });

  $('#ourdia a').click(function(e){
    e.preventDefault();
    var id = $(this).attr('data-id');
    $('#nav-tabContent #' + id).addClass('active show').siblings().removeClass('active show');
    $('#nav-tab #' + id + '-tab').addClass('active').siblings().removeClass('active');
  });
});



setTimeout(function(){
  jQuery('.slick-products').slick({
    infinite: true,
    slidesToShow: 3,
    slidesToScroll: 3,
    responsive: [
    {
      breakpoint: 600,
      settings: {
        slidesToShow: 2,
        slidesToScroll: 2
      }
    },
    {
      breakpoint: 320,
      settings: {
        slidesToShow: 1,
        slidesToScroll: 1
      }
    }
  ]
  });
}, 1500);

// Sticky Add to cart Button

jQuery(window).on('scroll', function() { 
  var $ = jQuery;
  if ($(window).scrollTop() >= $('.product-section-list').offset().top + $('.product-section-list').outerHeight() - window.innerHeight) {
    $('.sticky-btn').css('display', 'flex');
  } else {
    $('.sticky-btn').css('display', 'none');
  }
});

jQuery(window).on('scroll', function() { 
  var $ = jQuery;
  if ($(window).scrollTop() >= $('.result5 .site-footer').offset().top - window.innerHeight) {
    $('.sticky-btn').css('position', 'static');
  } else {
    $('.sticky-btn').css('position', 'fixed');
  }
});

$(document).ready(function(){
  if ($(window).width() < 768) {
    setTimeout(function(){
      $('.result_doctor_slides').slick({
        slidesToShow: 2,
        slidesToScroll: 1,
        autoplay: true,
        dots: true,
        arrows: false,
        autoplaySpeed: 2000,
      });
    }, 1500);
  }
});